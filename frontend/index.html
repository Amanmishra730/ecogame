<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EcoLearn - Environmental Education Platform</title>
    <meta name="description" content="Interactive eco-education platform with quizzes, games, and gamification to learn about environmental conservation" />
    <meta name="author" content="EcoLearn Team" />

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#22c55e" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="EcoLearn" />
    <meta name="msapplication-TileColor" content="#22c55e" />
    <meta name="msapplication-config" content="/browserconfig.xml" />
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json" />
    
    <!-- Icons -->
    <!-- Explicitly set an empty favicon to remove the heart icon in the tab -->
    <link rel="icon" type="image/svg+xml" href="/icon.svg" />
    <link rel="shortcut icon" type="image/svg+xml" href="/icon.svg" />
    <link rel="apple-touch-icon" href="/icon-192.png" />

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="EcoLearn - Environmental Education Platform" />
    <meta property="og:description" content="Interactive eco-education platform with quizzes, games, and gamification to learn about environmental conservation" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/icon-192.png" />
    <meta property="og:url" content="https://ecolearn.app" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="EcoLearn - Environmental Education Platform" />
    <meta name="twitter:description" content="Interactive eco-education platform with quizzes, games, and gamification to learn about environmental conservation" />
    <meta name="twitter:image" content="/icon-192.png" />
  </head>

  <body>
    <div id="root"></div>
    <!-- Dev-only: aggressively unregister any service workers and clear caches to avoid stale bundles -->
    <script>
      (async function () {
        try {
          const isLocal = location.hostname === 'localhost' || location.hostname === '127.0.0.1';
          if (isLocal && 'serviceWorker' in navigator) {
            const regs = await navigator.serviceWorker.getRegistrations();
            await Promise.all(regs.map(r => r.unregister()));
            if (window.caches && caches.keys) {
              const keys = await caches.keys();
              await Promise.all(keys.map(k => caches.delete(k)));
            }
            // Also ensure no active controller remains
            if (navigator.serviceWorker.controller) {
              navigator.serviceWorker.controller.postMessage({ type: 'SKIP_WAITING' });
            }
            console.log('[DEV] Unregistered all service workers and cleared caches');
          }
        } catch (e) {
          console.warn('Dev SW cleanup failed:', e);
        }
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
